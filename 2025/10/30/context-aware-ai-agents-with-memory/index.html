<!doctype html>







<html
  class="not-ready lg:text-base"
  style="--bg:#faf8f1"
  lang="en-us"
  dir="ltr"
><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>Building Context-Aware AI Agents with Memory in AgenticGoKit - Kunal Kushwaha</title>

  
  <meta name="theme-color" />

  <meta name="description" content="
One of the biggest challenges in building AI agents is making them remember. Users expect conversational agents to recall previous interactions, maintain context across multiple turns, and provide personalized responses based on conversation history.
AgenticGoKit&rsquo;s memory system solves this elegantly with a unified interface that supports:

Conversation history - Sequential chat memory
RAG (Retrieval Augmented Generation) - Semantic search over memories
Memory tracking - Monitor memory usage and query performance
Session management - Scope memories to conversation sessions

In this post, we&rsquo;ll build a real interactive chat agent that demonstrates these features." />
  <meta name="author" content="Kunal Kushwaha" /><link rel="preload stylesheet" as="style" href="https://kunalkushwaha.github.io/main.min.css" />

  
  <link rel="preload" as="image" href="https://kunalkushwaha.github.io/theme.png" />

  

  <link rel="preload" as="image" href="https://kunalkushwaha.github.io/twitter.svg" /><link rel="preload" as="image" href="https://kunalkushwaha.github.io/github.svg" /><link rel="preload" as="image" href="https://kunalkushwaha.github.io/linkedin.svg" />

  <script
    defer
    src="https://kunalkushwaha.github.io/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>

  
  <link
    rel="icon"
    href="https://kunalkushwaha.github.io/favicon.ico"
  />
  <link
    rel="apple-touch-icon"
    href="https://kunalkushwaha.github.io/apple-touch-icon.png"
  />

  <meta name="generator" content="Hugo 0.147.2">
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-K16B935QET"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-K16B935QET');
        }
      </script>
  <meta itemprop="name" content="Building Context-Aware AI Agents with Memory in AgenticGoKit">
  <meta itemprop="description" content="One of the biggest challenges in building AI agents is making them remember. Users expect conversational agents to recall previous interactions, maintain context across multiple turns, and provide personalized responses based on conversation history.
AgenticGoKit’s memory system solves this elegantly with a unified interface that supports:
Conversation history - Sequential chat memory RAG (Retrieval Augmented Generation) - Semantic search over memories Memory tracking - Monitor memory usage and query performance Session management - Scope memories to conversation sessions In this post, we’ll build a real interactive chat agent that demonstrates these features.">
  <meta itemprop="datePublished" content="2025-10-30T02:18:55+09:00">
  <meta itemprop="dateModified" content="2025-10-30T02:18:55+09:00">
  <meta itemprop="wordCount" content="2653">
  <meta itemprop="keywords" content="Go,Ai,Context,Agenticgokit,Workflows,AIagents,Memoryagents"><meta property="og:url" content="https://kunalkushwaha.github.io/2025/10/30/context-aware-ai-agents-with-memory/">
  <meta property="og:site_name" content="Kunal Kushwaha">
  <meta property="og:title" content="Building Context-Aware AI Agents with Memory in AgenticGoKit">
  <meta property="og:description" content="One of the biggest challenges in building AI agents is making them remember. Users expect conversational agents to recall previous interactions, maintain context across multiple turns, and provide personalized responses based on conversation history.
AgenticGoKit’s memory system solves this elegantly with a unified interface that supports:
Conversation history - Sequential chat memory RAG (Retrieval Augmented Generation) - Semantic search over memories Memory tracking - Monitor memory usage and query performance Session management - Scope memories to conversation sessions In this post, we’ll build a real interactive chat agent that demonstrates these features.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2025-10-30T02:18:55+09:00">
    <meta property="article:modified_time" content="2025-10-30T02:18:55+09:00">
    <meta property="article:tag" content="Go">
    <meta property="article:tag" content="Ai">
    <meta property="article:tag" content="Context">
    <meta property="article:tag" content="Agenticgokit">
    <meta property="article:tag" content="Workflows">
    <meta property="article:tag" content="AIagents">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Building Context-Aware AI Agents with Memory in AgenticGoKit">
  <meta name="twitter:description" content="One of the biggest challenges in building AI agents is making them remember. Users expect conversational agents to recall previous interactions, maintain context across multiple turns, and provide personalized responses based on conversation history.
AgenticGoKit’s memory system solves this elegantly with a unified interface that supports:
Conversation history - Sequential chat memory RAG (Retrieval Augmented Generation) - Semantic search over memories Memory tracking - Monitor memory usage and query performance Session management - Scope memories to conversation sessions In this post, we’ll build a real interactive chat agent that demonstrates these features.">

  <link rel="canonical" href="https://kunalkushwaha.github.io/2025/10/30/context-aware-ai-agents-with-memory/" />
</head>
<body
    class="bg-(--bg) text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"
  ><header
  class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"
>
  <div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto">
    <a
      class="-translate-y-[1px] text-2xl font-medium"
      href="https://kunalkushwaha.github.io/"
      >Kunal Kushwaha</a
    >
    <div
      class="btn-dark text-[0px] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8"
    role="button"
    aria-label="Menu"
  ></div>

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"
  ><nav
      class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"
    ><a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="../../../../"
        >Blog</a
      ><a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="https://speakerdeck.com/kunalkushwaha"
        >Slide Deck</a
      ><a
        class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal"
        href="../../../../about/"
        >About</a
      ></nav><nav
      class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"
    >
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/kunalkushwaha"
        target="_blank"
        rel="me"
      >twitter</a>
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./github.svg)"
        href="https://github.com/kunalkushwaha"
        target="_blank"
        rel="me"
      >github</a>
      <a
        class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./linkedin.svg)"
        href="https://linkedin.com/in/kunalkushwaha"
        target="_blank"
        rel="me"
      >linkedin</a>
    </nav>
  </div>
</header>
<main
      class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-14 pb-16"
    ><article>
  <header class="mb-14">
    <h1 class="my-0! pb-2.5">Building Context-Aware AI Agents with Memory in AgenticGoKit</h1><div class="text-xs antialiased opacity-60"><time>Oct 30, 2025</time></div></header>

  <section><p><img src="http://kunalkushwaha.github.io/memory-quote.PNG" alt="Simple streaming (terminal)"></p>
<p>One of the biggest challenges in building AI agents is making them <strong>remember</strong>. Users expect conversational agents to recall previous interactions, maintain context across multiple turns, and provide personalized responses based on conversation history.</p>
<p>AgenticGoKit&rsquo;s memory system solves this elegantly with a unified interface that supports:</p>
<ul>
<li>Conversation history - Sequential chat memory</li>
<li>RAG (Retrieval Augmented Generation) - Semantic search over memories</li>
<li>Memory tracking - Monitor memory usage and query performance</li>
<li>Session management - Scope memories to conversation sessions</li>
</ul>
<p>In this post, we&rsquo;ll build a real interactive chat agent that demonstrates these features.</p>
<hr>
<p><em>Discover how to create conversational AI agents that remember past interactions and provide personalized, context-aware responses</em></p>
<hr>
<h2 id="the-memory-problem">The Memory Problem</h2>
<p>Consider a simple conversation:</p>
<pre tabindex="0"><code>User: &#34;My name is Sarah and I love hiking.&#34;
Assistant: &#34;Nice to meet you, Sarah! Hiking is a wonderful activity.&#34;

User: &#34;What do you know about me?&#34;
Assistant: &#34;I don&#39;t have any information about you.&#34;
</code></pre><p>Without memory, each interaction is isolated. The agent forgets everything immediately.</p>
<h2 id="the-agenticgokit-solution">The AgenticGoKit Solution</h2>
<p>With AgenticGoKit&rsquo;s memory system, the same conversation becomes:</p>
<pre tabindex="0"><code>User: &#34;My name is Sarah and I love hiking.&#34;
Assistant: &#34;Nice to meet you, Sarah! Hiking is a wonderful activity.&#34;
[Memory] 2 queries performed

User: &#34;What do you know about me?&#34;
Assistant: &#34;Based on our conversation, I know your name is Sarah and you enjoy hiking!&#34;
[Memory] 2 queries performed
</code></pre><p>The agent remembers! Let&rsquo;s see how to build this.</p>
<h2 id="setting-up-memory-enabled-agent">Setting Up Memory-Enabled Agent</h2>
<h3 id="1-configuration">1. Configuration</h3>
<p>First, configure your agent with memory support:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">NewBuilder</span>(<span style="color:#e6db74">&#34;chat-assistant&#34;</span>).
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">WithConfig</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">Config</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;chat-assistant&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">SystemPrompt</span>: <span style="color:#e6db74">`You are a helpful and friendly chat assistant.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">You remember details from our conversation and provide personalized responses.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Be conversational and engaging while being helpful.`</span>,
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// LLM Configuration</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LLM</span>: <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">LLMConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Provider</span>:    <span style="color:#e6db74">&#34;ollama&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Model</span>:       <span style="color:#e6db74">&#34;gpt-oss:120b-cloud&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Temperature</span>: <span style="color:#ae81ff">0.7</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">MaxTokens</span>:   <span style="color:#ae81ff">2000</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Memory Configuration</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;memory&#34;</span>, <span style="color:#75715e">// In-memory provider</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">MaxTokens</span>:       <span style="color:#ae81ff">1000</span>, <span style="color:#75715e">// Context window for memories</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">PersonalWeight</span>:  <span style="color:#ae81ff">0.8</span>,  <span style="color:#75715e">// Prioritize conversation history</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">KnowledgeWeight</span>: <span style="color:#ae81ff">0.2</span>,  <span style="color:#75715e">// Lower weight for knowledge base</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">HistoryLimit</span>:    <span style="color:#ae81ff">20</span>,   <span style="color:#75715e">// Keep last 20 messages</span>
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Timeout</span>: <span style="color:#ae81ff">300</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>    }).
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Initialize the agent</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Initialize</span>(<span style="color:#a6e22e">ctx</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to initialize agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Cleanup</span>(<span style="color:#a6e22e">ctx</span>)
</span></span></code></pre></div><h3 id="2-understanding-memory-configuration">2. Understanding Memory Configuration</h3>
<p>Let&rsquo;s break down the key memory settings:</p>
<p><strong>Provider Options:</strong></p>
<ul>
<li><code>&quot;memory&quot;</code> - In-memory storage (simple, great for demos)</li>
<li><code>&quot;pgvector&quot;</code> - PostgreSQL with vector embeddings (production-ready)</li>
<li><code>&quot;weaviate&quot;</code> - Weaviate vector database</li>
<li>Custom providers via plugin system</li>
</ul>
<p><strong>RAG Configuration:</strong></p>
<ul>
<li><strong>MaxTokens</strong>: Maximum tokens for retrieved context (affects prompt size)</li>
<li><strong>PersonalWeight</strong>: Priority for conversation history (0.0-1.0)</li>
<li><strong>KnowledgeWeight</strong>: Priority for knowledge base documents (0.0-1.0)</li>
<li><strong>HistoryLimit</strong>: Number of recent messages to include</li>
</ul>
<p><strong>Pro Tip:</strong> For conversational agents, set <code>PersonalWeight</code> higher (0.7-0.9) to prioritize recent dialogue over general knowledge.</p>
<h2 id="building-an-interactive-chat-loop">Building an Interactive Chat Loop</h2>
<h3 id="basic-non-streaming-version">Basic (Non-Streaming) Version</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">scanner</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bufio</span>.<span style="color:#a6e22e">NewScanner</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdin</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">conversationCount</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Start chatting! Type &#39;quit&#39; or &#39;exit&#39; to end.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#e6db74">&#34;You: &#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">scanner</span>.<span style="color:#a6e22e">Scan</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">userInput</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">TrimSpace</span>(<span style="color:#a6e22e">scanner</span>.<span style="color:#a6e22e">Text</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">userInput</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">ToLower</span>(<span style="color:#a6e22e">userInput</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;quit&#34;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Goodbye!&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">conversationCount</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\nAssistant (Turn %d):\n&#34;</span>, <span style="color:#a6e22e">conversationCount</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Run agent with memory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">userInput</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Error: %v\n\n&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Display response</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%s\n&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Content</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Show memory usage</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryUsed</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\n[Memory] Used (%d queries)\n&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;[Time] Response time: %v\n&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Duration</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Repeat</span>(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#ae81ff">60</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="streaming-version-real-time-token-by-token">Streaming Version (Real-time Token-by-Token)</h3>
<p>For a more interactive experience, use streaming:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">stream</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">RunStream</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">userInput</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Error: %v\n&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Process streaming chunks</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> <span style="color:#a6e22e">chunk</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">stream</span>.<span style="color:#a6e22e">Chunks</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">chunk</span>.<span style="color:#a6e22e">Type</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">ChunkTypeDelta</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#a6e22e">chunk</span>.<span style="color:#a6e22e">Delta</span>) <span style="color:#75715e">// Print tokens as they arrive</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">ChunkTypeError</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\nError: %v\n&#34;</span>, <span style="color:#a6e22e">chunk</span>.<span style="color:#a6e22e">Error</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">ChunkTypeDone</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>() <span style="color:#75715e">// New line after response</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Get final result with memory stats</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">stream</span>.<span style="color:#a6e22e">Wait</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Error: %v\n&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\n[Memory] %d queries | [Time] %v\n&#34;</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Duration</span>)
</span></span></code></pre></div><h2 id="how-memory-works-under-the-hood">How Memory Works Under the Hood</h2>
<p>When you send a message to a memory-enabled agent, here&rsquo;s what happens:</p>
<pre tabindex="0"><code class="language-mermaid" data-lang="mermaid">graph TD
    A[User Input] --&gt; B[Memory Query Phase]
    B --&gt; C{RAG Query}
    B --&gt; D{Chat History}
    C --&gt; E[Semantic Search]
    D --&gt; F[Sequential Retrieval]
    E --&gt; G[Relevant Memories]
    F --&gt; H[Recent Messages]
    G --&gt; I[Context Enrichment]
    H --&gt; I
    I --&gt; J[Enriched Prompt]
    J --&gt; K[LLM Generation]
    K --&gt; L[Response]
    L --&gt; M[Memory Storage]
    M --&gt; N[Update RAG Index]
    M --&gt; O[Update Chat History]
</code></pre><h3 id="1-memory-query-phase-before-llm-call">1. <strong>Memory Query Phase</strong> (Before LLM call)</h3>
<pre tabindex="0"><code>Input: &#34;What did we discuss earlier?&#34;

Memory System performs:
├─ RAG Query: Semantic search for relevant past memories
│  └─ Returns: Top-k similar conversation snippets
│
└─ History Fetch: Get recent sequential messages
   └─ Returns: Last N conversation turns
</code></pre><p>Typically <strong>2 queries per turn</strong>:</p>
<ol>
<li>One RAG semantic query</li>
<li>One chat history retrieval</li>
</ol>
<h3 id="2-context-enrichment">2. <strong>Context Enrichment</strong></h3>
<p>The agent uses specialized APIs to combine context into an enriched prompt:</p>
<p><strong>Key APIs Used:</strong></p>
<ul>
<li><code>EnrichWithMemory()</code> - Performs RAG semantic search and returns relevant memories</li>
<li><code>BuildChatHistoryContext()</code> - Retrieves recent conversation history</li>
<li><code>BuildEnrichedPrompt()</code> - Combines all context (system prompt, memories, history, user input)</li>
</ul>
<p><strong>How it works in <code>agent.Run()</code>:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Step 2: Enhance prompt with memory context if memory is enabled</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Use the new BuildEnrichedPrompt utility for proper RAG integration</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">memoryQueries</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">memoryProvider</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Memory</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Convert llm.Prompt to core.Prompt for enrichment</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">corePrompt</span> <span style="color:#a6e22e">core</span>.<span style="color:#a6e22e">Prompt</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">corePrompt</span>, <span style="color:#a6e22e">memoryQueries</span> = <span style="color:#a6e22e">BuildEnrichedPrompt</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">prompt</span>.<span style="color:#a6e22e">System</span>, <span style="color:#a6e22e">prompt</span>.<span style="color:#a6e22e">User</span>, <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">memoryProvider</span>, <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">Memory</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Update the LLM prompt with enriched content</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prompt</span>.<span style="color:#a6e22e">System</span> = <span style="color:#a6e22e">corePrompt</span>.<span style="color:#a6e22e">System</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">prompt</span>.<span style="color:#a6e22e">User</span> = <span style="color:#a6e22e">corePrompt</span>.<span style="color:#a6e22e">User</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <code>BuildEnrichedPrompt</code> function internally:</p>
<ol>
<li>Calls <code>EnrichWithMemory()</code> to get RAG context (counts as 1 query)</li>
<li>Calls <code>BuildChatHistoryContext()</code> to get chat history (counts as 1 query if performed)</li>
<li>Combines everything into the final enriched prompt</li>
</ol>
<p>The agent combines:</p>
<ul>
<li>Your system prompt</li>
<li>Retrieved memories (RAG results from <code>EnrichWithMemory</code>)</li>
<li>Recent chat history (from <code>BuildChatHistoryContext</code>)</li>
<li>Current user input</li>
</ul>
<p>Into an enriched prompt sent to the LLM via <code>BuildEnrichedPrompt</code>.</p>
<h3 id="3-response-generation">3. <strong>Response Generation</strong></h3>
<p>The LLM generates a response using the enriched context.</p>
<h3 id="4-memory-storage">4. <strong>Memory Storage</strong></h3>
<p>After response generation:</p>
<ul>
<li>User message is stored in memory</li>
<li>Assistant response is stored in memory</li>
<li>Both are available for future retrievals</li>
</ul>
<h3 id="5-result-tracking">5. <strong>Result Tracking</strong></h3>
<p>The <code>Result</code> object reports:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryUsed</span>      <span style="color:#75715e">// true if memory was accessed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>   <span style="color:#75715e">// Number of queries performed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Duration</span>        <span style="color:#75715e">// Total execution time</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">TokensUsed</span>      <span style="color:#75715e">// LLM tokens consumed</span>
</span></span></code></pre></div><h2 id="real-world-example-output">Real-World Example Output</h2>
<p>Here&rsquo;s what a real conversation looks like:</p>
<pre tabindex="0"><code>Interactive Chat Agent with Memory
===================================

You: My name is Sarah and I work as a software engineer in San Francisco.

Assistant (Turn 1):
Nice to meet you, Sarah! It&#39;s great to connect with a software engineer from 
San Francisco. The tech scene there is incredible! What kind of projects do 
you work on?

[Memory] Used (2 queries)
[Time] Response time: 3.2s
────────────────────────────────────────────────────────────

You: I mostly work on distributed systems and cloud infrastructure.

Assistant (Turn 2):
That sounds fascinating! Distributed systems and cloud infrastructure are 
critical areas in modern software engineering. Working on those systems in 
San Francisco must give you exposure to some cutting-edge technology. Are 
you working with any particular cloud providers or frameworks?

[Memory] Used (2 queries)
[Time] Response time: 3.5s
────────────────────────────────────────────────────────────

You: What do you know about me so far?

Assistant (Turn 3):
Based on our conversation, I know that:
- Your name is Sarah
- You work as a software engineer in San Francisco
- You focus on distributed systems and cloud infrastructure

These are really impressive areas of expertise! Is there anything specific 
about your work you&#39;d like to discuss?

[Memory] Used (2 queries)
[Time] Response time: 3.1s
────────────────────────────────────────────────────────────
</code></pre><p>Notice how the agent:</p>
<ol>
<li>Remembers the name &ldquo;Sarah&rdquo;</li>
<li>Recalls the job (software engineer in San Francisco)</li>
<li>References the technical specialization (distributed systems)</li>
<li>Maintains conversational context across turns</li>
</ol>
<h2 id="memory-query-counter-deep-dive">Memory Query Counter Deep Dive</h2>
<p>The memory query counter is particularly useful for:</p>
<h3 id="performance-monitoring">Performance Monitoring</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span> &gt; <span style="color:#ae81ff">5</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Warning: High memory query count: %d&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="understanding-memory-behavior">Understanding Memory Behavior</h3>
<p>Typical query counts:</p>
<ul>
<li>0 queries: Memory disabled or no memory configured</li>
<li>1 query: Only RAG or only history (unusual)</li>
<li>2 queries: Normal (1 RAG + 1 history fetch)</li>
<li>3+ queries: Multiple memory providers or custom implementations</li>
</ul>
<h3 id="cost-tracking">Cost Tracking</h3>
<p>For production systems using vector databases:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ConversationMetrics</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TotalTurns</span>       <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TotalMemQueries</span>  <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">AvgQueriesPerTurn</span> <span style="color:#66d9ef">float64</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalMemQueries</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">AvgQueriesPerTurn</span> = float64(<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalMemQueries</span>) <span style="color:#f92672">/</span> float64(<span style="color:#a6e22e">metrics</span>.<span style="color:#a6e22e">TotalTurns</span>)
</span></span></code></pre></div><h2 id="advanced-rag-vs-chat-history">Advanced: RAG vs. Chat History</h2>
<p>AgenticGoKit&rsquo;s memory system uses <strong>two complementary retrieval mechanisms</strong>:</p>
<h3 id="1-rag-retrieval-augmented-generation">1. <strong>RAG (Retrieval Augmented Generation)</strong></h3>
<p><strong>How it works:</strong></p>
<ul>
<li>Converts text to embeddings</li>
<li>Performs semantic similarity search</li>
<li>Finds conceptually related memories</li>
</ul>
<p><strong>Best for:</strong></p>
<ul>
<li>Finding relevant facts from many turns ago</li>
<li>Semantic understanding (&ldquo;what hobbies&rdquo; finds &ldquo;I like hiking&rdquo;)</li>
<li>Knowledge base queries</li>
</ul>
<p><strong>Example:</strong></p>
<pre tabindex="0"><code>Turn 1: &#34;I love hiking in the mountains&#34;
Turn 20: &#34;What outdoor activities do I enjoy?&#34;
         ↓ RAG retrieves Turn 1 (semantically similar)
</code></pre><h3 id="2-chat-history">2. <strong>Chat History</strong></h3>
<p><strong>How it works:</strong></p>
<ul>
<li>Sequential retrieval</li>
<li>Returns last N conversation turns</li>
<li>Maintains dialogue flow</li>
</ul>
<p><strong>Best for:</strong></p>
<ul>
<li>Recent context</li>
<li>Conversation continuity</li>
<li>Referencing &ldquo;earlier&rdquo; or &ldquo;just now&rdquo;</li>
</ul>
<p><strong>Example:</strong></p>
<pre tabindex="0"><code>Turn 18: &#34;I work in San Francisco&#34;
Turn 19: &#34;What city did I mention?&#34;
         ↓ Chat history provides Turn 18
</code></pre><h3 id="why-both">Why Both?</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">PersonalWeight</span>:  <span style="color:#ae81ff">0.8</span>,  <span style="color:#75715e">// Chat history priority</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">KnowledgeWeight</span>: <span style="color:#ae81ff">0.2</span>,  <span style="color:#75715e">// RAG semantic search priority</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">HistoryLimit</span>:    <span style="color:#ae81ff">20</span>,   <span style="color:#75715e">// Last 20 messages</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The weights balance:</p>
<ul>
<li><strong>High PersonalWeight</strong>: Prioritizes recent dialogue context, ensuring conversational continuity and immediate relevance</li>
<li><strong>High KnowledgeWeight</strong>: Prioritizes semantic relevance over recency, better for knowledge-intensive tasks</li>
</ul>
<p><strong>Why prioritize chat history for conversations?</strong> Recent dialogue provides immediate context, maintains conversation flow, and ensures the agent remembers what was just discussed. This creates more natural, coherent interactions compared to jumping between semantically similar but temporally distant memories.</p>
<h2 id="production-considerations">Production Considerations</h2>
<h3 id="1-choose-the-right-provider">1. <strong>Choose the Right Provider</strong></h3>
<p><strong>Development/Testing:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;memory&#34;</span>, <span style="color:#75715e">// In-memory, lost on restart</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Production:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;pgvector&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ConnectionString</span>: <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;DATABASE_URL&#34;</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Embedding</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">EmbeddingConfig</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;ollama&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Model</span>:    <span style="color:#e6db74">&#34;nomic-embed-text:latest&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="2-session-management">2. <strong>Session Management</strong></h3>
<p>Scope memories to user sessions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">sessionID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">memory</span>.<span style="color:#a6e22e">NewSession</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ctx</span> = <span style="color:#a6e22e">memory</span>.<span style="color:#a6e22e">SetSession</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">sessionID</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// All subsequent operations use this session</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;Hello&#34;</span>)
</span></span></code></pre></div><h3 id="3-token-budget-management">3. <strong>Token Budget Management</strong></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MaxTokens</span>: <span style="color:#ae81ff">1000</span>, <span style="color:#75715e">// Limit context size</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HistoryLimit</span>: <span style="color:#ae81ff">10</span>, <span style="color:#75715e">// Fewer turns = lower costs</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Why this matters:</strong></p>
<ul>
<li>LLM APIs charge per token</li>
<li>Larger context = higher costs per request</li>
<li>Balance context quality vs. cost</li>
</ul>
<h3 id="4-error-handling">4. <strong>Error Handling</strong></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">input</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Agent error: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryUsed</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Warning: Memory was not utilized&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Warning: No memory queries performed&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="comparing-memory-vs-no-memory">Comparing: Memory vs. No Memory</h2>
<p>Let&rsquo;s see the difference side-by-side:</p>
<table>
  <thead>
      <tr>
          <th>Aspect</th>
          <th>Without Memory</th>
          <th>With Memory</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Turn 1:</strong> &ldquo;My name is Alex&rdquo;</td>
          <td>&ldquo;Nice to meet you, Alex!&rdquo;</td>
          <td>&ldquo;Nice to meet you, Alex!&quot;<!-- raw HTML omitted --><em>[Memory] 2 queries</em></td>
      </tr>
      <tr>
          <td><strong>Turn 2:</strong> &ldquo;What&rsquo;s my name?&rdquo;</td>
          <td>&ldquo;I don&rsquo;t know your name.&rdquo;</td>
          <td>&ldquo;Your name is Alex!&quot;<!-- raw HTML omitted --><em>[Memory] 2 queries</em></td>
      </tr>
      <tr>
          <td><strong>Turn 3:</strong> &ldquo;What do I do?&rdquo;</td>
          <td>&ldquo;I don&rsquo;t have information about your profession.&rdquo;</td>
          <td>&ldquo;I don&rsquo;t recall you mentioning your profession yet. What do you do?&quot;<!-- raw HTML omitted --><em>[Memory] 2 queries</em></td>
      </tr>
      <tr>
          <td><strong>Turn 4:</strong> &ldquo;I&rsquo;m a teacher&rdquo;</td>
          <td>&ldquo;That&rsquo;s interesting!&rdquo;</td>
          <td>&ldquo;That&rsquo;s wonderful! As a teacher, you must have many interesting stories to share.&quot;<!-- raw HTML omitted --><em>[Memory] 2 queries</em></td>
      </tr>
      <tr>
          <td><strong>Turn 5:</strong> &ldquo;Tell me about myself&rdquo;</td>
          <td>&ldquo;I don&rsquo;t have personal information about you.&rdquo;</td>
          <td>&ldquo;Based on our conversation, I know you&rsquo;re Alex and you work as a teacher. You seem passionate about education!&quot;<!-- raw HTML omitted --><em>[Memory] 2 queries</em></td>
      </tr>
  </tbody>
</table>
<h3 id="without-memory-code">Without Memory (Code)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">QuickChatAgent</span>(<span style="color:#e6db74">&#34;gpt-4o-mini&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// No memory configuration</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result1</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;My name is Alex&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result2</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;What&#39;s my name?&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Response: &#34;I don&#39;t know your name&#34;</span>
</span></span></code></pre></div><h3 id="with-memory-code">With Memory (Code)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">NewBuilder</span>(<span style="color:#e6db74">&#34;agent&#34;</span>).
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">WithConfig</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">Config</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LLM</span>: <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">LLMConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;ollama&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Model</span>: <span style="color:#e6db74">&#34;gpt-oss:120b-cloud&#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;memory&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">PersonalWeight</span>: <span style="color:#ae81ff">0.8</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">HistoryLimit</span>: <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    }).
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result1</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;My name is Alex&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// [Memory] 2 queries</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result2</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;What&#39;s my name?&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Response: &#34;Your name is Alex!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// [Memory] 2 queries</span>
</span></span></code></pre></div><h2 id="common-pitfalls--best-practices">Common Pitfalls &amp; Best Practices</h2>
<h3 id="privacy--data-security">Privacy &amp; Data Security</h3>
<p><strong>Pitfall:</strong> Storing sensitive information in memory without user consent.</p>
<p><strong>Best Practice:</strong> Always implement data retention policies and give users control over their data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Clear user session data</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">memoryProvider</span>.<span style="color:#a6e22e">ClearSession</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">sessionID</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Failed to clear session: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Implement data retention limits</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">RetentionPolicy</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RetentionPolicy</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">MaxAge</span>:     <span style="color:#ae81ff">30</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">24</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Hour</span>, <span style="color:#75715e">// 30 days</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">MaxEntries</span>: <span style="color:#ae81ff">1000</span>,                <span style="color:#75715e">// Per session</span>
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="token-cost-explosion">Token Cost Explosion</h3>
<p><strong>Pitfall:</strong> Memory context grows unbounded, causing skyrocketing API costs.</p>
<p><strong>Best Practice:</strong> Set reasonable limits and monitor usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">MaxTokens</span>:    <span style="color:#ae81ff">1000</span>, <span style="color:#75715e">// Limit context size</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HistoryLimit</span>: <span style="color:#ae81ff">10</span>,   <span style="color:#75715e">// Limit conversation turns</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Monitor costs</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span> &gt; <span style="color:#ae81ff">5</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;High memory usage detected: %d queries&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="context-drift--hallucinations">Context Drift &amp; Hallucinations</h3>
<p><strong>Pitfall:</strong> Outdated or irrelevant memories confuse the agent.</p>
<p><strong>Best Practice:</strong> Use session management and implement relevance scoring:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Start new conversation sessions</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sessionID</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">memory</span>.<span style="color:#a6e22e">NewSession</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ctx</span> = <span style="color:#a6e22e">memory</span>.<span style="color:#a6e22e">SetSession</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">sessionID</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// AgenticGoKit automatically handles session isolation</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#e6db74">&#34;Hello, I&#39;m starting a new conversation&#34;</span>)
</span></span></code></pre></div><h3 id="performance-degradation">Performance Degradation</h3>
<p><strong>Pitfall:</strong> Memory queries slow down response times.</p>
<p><strong>Best Practice:</strong> Choose appropriate providers and optimize configurations:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// Development: Fast in-memory</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{<span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;memory&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Production: Optimized vector database</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;pgvector&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Embedding</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">EmbeddingConfig</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;ollama&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Model</span>:    <span style="color:#e6db74">&#34;nomic-embed-text:latest&#34;</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="over-reliance-on-memory">Over-Reliance on Memory</h3>
<p><strong>Pitfall:</strong> Agent becomes too dependent on past context, ignoring current instructions.</p>
<p><strong>Best Practice:</strong> Balance memory weight with current context importance:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">PersonalWeight</span>:  <span style="color:#ae81ff">0.7</span>,  <span style="color:#75715e">// Memory context</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">KnowledgeWeight</span>: <span style="color:#ae81ff">0.3</span>,  <span style="color:#75715e">// Current/general knowledge</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="complete-working-example">Complete Working Example</h2>
<p>Here&rsquo;s the full code for a production-ready memory-enabled chat agent:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;bufio&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/core/vnext&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">_</span> <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/plugins/llm/ollama&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">_</span> <span style="color:#e6db74">&#34;github.com/kunalkushwaha/agenticgokit/plugins/memory/memory&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Create agent with memory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">agent</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">NewBuilder</span>(<span style="color:#e6db74">&#34;chat-assistant&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WithConfig</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">Config</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;chat-assistant&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">SystemPrompt</span>: <span style="color:#e6db74">`You are a helpful and friendly chat assistant.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">You remember details from our conversation and provide personalized responses.`</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">LLM</span>: <span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">LLMConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Provider</span>:    <span style="color:#e6db74">&#34;ollama&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Model</span>:       <span style="color:#e6db74">&#34;gpt-oss:120b-cloud&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Temperature</span>: <span style="color:#ae81ff">0.7</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">MaxTokens</span>:   <span style="color:#ae81ff">2000</span>,
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Memory</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">MemoryConfig</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Provider</span>: <span style="color:#e6db74">&#34;memory&#34;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">RAG</span>: <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">vnext</span>.<span style="color:#a6e22e">RAGConfig</span>{
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">MaxTokens</span>:       <span style="color:#ae81ff">1000</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">PersonalWeight</span>:  <span style="color:#ae81ff">0.8</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">KnowledgeWeight</span>: <span style="color:#ae81ff">0.2</span>,
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">HistoryLimit</span>:    <span style="color:#ae81ff">20</span>,
</span></span><span style="display:flex;"><span>                },
</span></span><span style="display:flex;"><span>            },
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Timeout</span>: <span style="color:#ae81ff">300</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Second</span>,
</span></span><span style="display:flex;"><span>        }).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to create agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Initialize</span>(<span style="color:#a6e22e">ctx</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;Failed to initialize agent: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Cleanup</span>(<span style="color:#a6e22e">ctx</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Chat Agent Ready!&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Try: &#39;My name is [name]&#39; then ask &#39;What do you know about me?&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanner</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bufio</span>.<span style="color:#a6e22e">NewScanner</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdin</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">conversationCount</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Print</span>(<span style="color:#e6db74">&#34;You: &#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">scanner</span>.<span style="color:#a6e22e">Scan</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">userInput</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">TrimSpace</span>(<span style="color:#a6e22e">scanner</span>.<span style="color:#a6e22e">Text</span>())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">userInput</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">ToLower</span>(<span style="color:#a6e22e">userInput</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;quit&#34;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">conversationCount</span><span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\nAssistant (Turn %d):\n&#34;</span>, <span style="color:#a6e22e">conversationCount</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">agent</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">userInput</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Error: %v\n\n&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;%s\n&#34;</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Content</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryUsed</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;\n[Memory] %d queries | [Time] %v\n&#34;</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">MemoryQueries</span>, <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">Duration</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Repeat</span>(<span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#ae81ff">60</span>))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;\nThanks for chatting!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="running-the-examples">Running the Examples</h2>
<p>AgenticGoKit includes two complete demos:</p>
<h3 id="1-basic-memory-demo">1. Basic Memory Demo</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd examples/vnext/conversation-memory-demo
</span></span><span style="display:flex;"><span>go run main.go
</span></span></code></pre></div><p>Features:</p>
<ul>
<li>Standard request/response flow</li>
<li>Memory tracking and statistics</li>
<li>Simple to understand and modify</li>
</ul>
<h3 id="2-streaming-memory-demo">2. Streaming Memory Demo</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd examples/vnext/conversation-memory-stream-demo
</span></span><span style="display:flex;"><span>go run main.go
</span></span></code></pre></div><p>Features:</p>
<ul>
<li>Real-time token-by-token streaming</li>
<li>Live memory query feedback</li>
<li>Enhanced user experience</li>
</ul>
<h2 id="key-takeaways">Key Takeaways</h2>
<ol>
<li>
<p><strong>Memory makes agents conversational</strong> - Context awareness transforms isolated Q&amp;A into natural dialogue</p>
</li>
<li>
<p><strong>Two-tier retrieval is powerful</strong> - RAG + chat history provides both semantic understanding and conversational flow</p>
</li>
<li>
<p><strong>Memory queries are trackable</strong> - Monitor performance and costs with <code>result.MemoryQueries</code></p>
</li>
<li>
<p><strong>Configuration is flexible</strong> - Tune weights, limits, and providers for your use case</p>
</li>
<li>
<p><strong>Production-ready options exist</strong> - Scale from in-memory prototypes to PostgreSQL/Weaviate production deployments</p>
</li>
</ol>
<h2 id="next-steps">Next Steps</h2>
<ul>
<li>Explore the <a href="https://docs.agenticgokit.com/reference/api/vnext/memory">Memory API documentation</a></li>
<li>Try the <a href="https://github.com/AgenticGoKit/AgenticGoKit/tree/master/examples/vnext/conversation-memory-stream-demo">streaming examples</a></li>
<li>Check out <a href="https://docs.agenticgokit.com/reference/api/vnext/workflow">workflow memory patterns</a></li>
</ul>
<h2 id="resources">Resources</h2>
<ul>
<li><strong>AgenticGoKit Repository</strong>: <a href="https://github.com/AgenticGoKit/AgenticGoKit">github.com/kunalkushwaha/agenticgokit</a></li>
<li><strong>Documentation</strong>: <a href="https://docs.agenticgokit.com/reference/api/vnext/README">docs/reference/api/vnext/</a></li>
<li><strong>Memory Examples</strong>: <a href="https://github.com/AgenticGoKit/AgenticGoKit/tree/master/examples/vnext/conversation-memory-demo">examples/vnext/conversation-memory-demo/</a></li>
</ul>
<hr>
<p><em>Built with AgenticGoKit v0.4.5 - The Go framework for production-ready AI agents</em></p>
<hr>
<h3 id="contribute-to-agenticgokit">Contribute to AgenticGoKit</h3>
<p><em>Open-source Agentic AI framework in Go for building, orchestrating, and deploying intelligent agents. LLM-agnostic, event-driven, with multi-agent workflows, MCP tool discovery, and production-grade observability.</em></p>
<p>AgenticGoKit is an open-source project that welcomes contributions! Whether you&rsquo;re interested in:</p>
<ul>
<li>Adding new LLM providers or memory backends</li>
<li>Improving documentation and examples</li>
<li>Implementing new agent patterns or workflows</li>
<li>Fixing bugs or adding features</li>
<li>Writing tests and improving code quality</li>
</ul>
<p>We&rsquo;d love to have you join our community. Check out our <a href="docs/contributors/">contributing guide</a> and <a href="https://github.com/AgenticGoKit/AgenticGoKit">GitHub repository</a> to get started.</p>
</section>

  <footer class="mt-12 flex flex-wrap"><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/go"
      >go</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/ai"
      >ai</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/context"
      >context</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/agenticgokit"
      >agenticgokit</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/workflows"
      >workflows</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/aiagents"
      >AIagents</a
    ><a
      class="mb-1.5 rounded-lg bg-black/[3%] px-5 py-1 no-underline hover:bg-black/[6%] ltr:mr-1.5 rtl:ml-1.5 dark:bg-white/[8%] dark:hover:bg-white/[12%]"
      href="https://kunalkushwaha.github.io/tags/memoryagents"
      >memoryagents</a
    ></footer><nav
    class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg leading-[1.2]! *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"
  ><a
      class="justify-end pl-3 ltr:ml-auto rtl:mr-auto"
      href="https://kunalkushwaha.github.io/2025/10/26/streaming-agenticgokit/"
      ><span>Streaming AI Responses in Go with AgenticGoKit</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a
    ></nav><div class="mt-24" id="disqus_thread"></div>
  <script>
    const disqusShortname = 'kunalkushwaha';
    const script = document.createElement('script');
    script.src = 'https://' + disqusShortname + '.disqus.com/embed.js';
    script.setAttribute('data-timestamp', +new Date());
    document.head.appendChild(script);
  </script><script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>
<script>
  Array.from(document.getElementsByClassName('language-mermaid')).forEach(
    (el) => {
      el.parentElement.outerHTML = `<div class="mermaid [&_svg]:block [&_svg]:m-auto">${el.innerHTML}</div>`;
    },
  );
</script></article></main><footer
  class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"
>
  <div class="mr-auto">Kunal Kushwaha</div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >powered by hugo️️</a
  >️
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >hugo-paper</a
  >
</footer>
</body>
</html>
